Jul-05 15:41:07.896 [main] DEBUG nextflow.cli.Launcher - $> nextflow run main.nf --input ./test_data --resultsDir ./test_results --threads 8 --ram '32 GB' -profile test
Jul-05 15:41:07.941 [main] DEBUG nextflow.cli.CmdRun - N E X T F L O W  ~  version 25.04.4
Jul-05 15:41:07.965 [main] DEBUG nextflow.plugin.PluginsFacade - Setting up plugin manager > mode=prod; embedded=false; plugins-dir=/home/phemarajata/.nextflow/plugins; core-plugins: nf-amazon@2.15.0,nf-azure@1.16.0,nf-cloudcache@0.4.3,nf-codecommit@0.2.3,nf-console@1.2.1,nf-google@1.21.0,nf-k8s@1.0.0,nf-tower@1.11.3,nf-wave@1.12.1
Jul-05 15:41:07.980 [main] INFO  o.pf4j.DefaultPluginStatusProvider - Enabled plugins: []
Jul-05 15:41:07.981 [main] INFO  o.pf4j.DefaultPluginStatusProvider - Disabled plugins: []
Jul-05 15:41:07.983 [main] INFO  org.pf4j.DefaultPluginManager - PF4J version 3.12.0 in 'deployment' mode
Jul-05 15:41:07.990 [main] INFO  org.pf4j.AbstractPluginManager - No plugins
Jul-05 15:41:08.015 [main] DEBUG nextflow.config.ConfigBuilder - Found config local: /home/phemarajata/combined_poppunk_poppipe/nextflow.config
Jul-05 15:41:08.019 [main] DEBUG nextflow.config.ConfigBuilder - Parsing config file: /home/phemarajata/combined_poppunk_poppipe/nextflow.config
Jul-05 15:41:08.052 [main] DEBUG n.secret.LocalSecretsProvider - Secrets store: /home/phemarajata/.nextflow/secrets/store.json
Jul-05 15:41:08.054 [main] DEBUG nextflow.secret.SecretsLoader - Discovered secrets providers: [nextflow.secret.LocalSecretsProvider@19f040ba] - activable => nextflow.secret.LocalSecretsProvider@19f040ba
Jul-05 15:41:08.062 [main] DEBUG nextflow.config.ConfigBuilder - Applying config profile: `test`
Jul-05 15:41:08.676 [main] DEBUG nextflow.config.ConfigBuilder - Available config profiles: [standard, slurm, pbs, test, conda, singularity, aws, local, docker]
Jul-05 15:41:08.701 [main] DEBUG nextflow.cli.CmdRun - Applied DSL=2 from script declaration
Jul-05 15:41:08.711 [main] DEBUG nextflow.cli.CmdRun - Launching `main.nf` [scruffy_gates] DSL2 - revision: 978c755289
Jul-05 15:41:08.713 [main] DEBUG nextflow.plugin.PluginsFacade - Plugins default=[]
Jul-05 15:41:08.713 [main] DEBUG nextflow.plugin.PluginsFacade - Plugins resolved requirement=[]
Jul-05 15:41:08.746 [main] DEBUG nextflow.Session - Session UUID: d6669822-f6b0-489c-8543-5dd285d5c396
Jul-05 15:41:08.747 [main] DEBUG nextflow.Session - Run name: scruffy_gates
Jul-05 15:41:08.747 [main] DEBUG nextflow.Session - Executor pool size: 22
Jul-05 15:41:08.752 [main] DEBUG nextflow.file.FilePorter - File porter settings maxRetries=3; maxTransfers=50; pollTimeout=null
Jul-05 15:41:08.756 [main] DEBUG nextflow.util.ThreadPoolBuilder - Creating thread pool 'FileTransfer' minSize=10; maxSize=66; workQueue=LinkedBlockingQueue[-1]; allowCoreThreadTimeout=false
Jul-05 15:41:08.769 [main] DEBUG nextflow.cli.CmdRun - 
  Version: 25.04.4 build 5950
  Created: 16-06-2025 14:23 UTC (21:23 ICST)
  System: Linux 6.11.0-29-generic
  Runtime: Groovy 4.0.26 on Java HotSpot(TM) 64-Bit Server VM 17.0.12+8-LTS-286
  Encoding: UTF-8 (UTF-8)
  Process: 2557093@phemarajata-Stealth-16-MercedesAMG-A1VGG [127.0.1.1]
  CPUs: 22 - Mem: 62.3 GB (1.6 GB) - Swap: 8 GB (7.1 GB)
Jul-05 15:41:08.789 [main] DEBUG nextflow.Session - Work-dir: /home/phemarajata/combined_poppunk_poppipe/work [ext2/ext3]
Jul-05 15:41:08.818 [main] DEBUG nextflow.executor.ExecutorFactory - Extension executors providers=[]
Jul-05 15:41:08.829 [main] DEBUG nextflow.Session - Observer factory: DefaultObserverFactory
Jul-05 15:41:08.865 [main] DEBUG nextflow.Session - Observer factory (v2): LinObserverFactory
Jul-05 15:41:08.896 [main] DEBUG nextflow.cache.CacheFactory - Using Nextflow cache factory: nextflow.cache.DefaultCacheFactory
Jul-05 15:41:08.901 [main] DEBUG nextflow.util.CustomThreadPool - Creating default thread pool > poolSize: 23; maxThreads: 1000
Jul-05 15:41:08.934 [main] DEBUG nextflow.Session - Session start
Jul-05 15:41:08.937 [main] DEBUG nextflow.trace.TraceFileObserver - Workflow started -- trace file: /home/phemarajata/combined_poppunk_poppipe/test_results/reports/trace.txt
Jul-05 15:41:09.127 [main] DEBUG nextflow.script.ScriptRunner - > Launching execution
Jul-05 15:41:09.131 [main] INFO  nextflow.script.BaseScript - ▶ FASTA input directory:  ./test_data
Jul-05 15:41:09.132 [main] INFO  nextflow.script.BaseScript - ▶ Results directory:      ./test_results
Jul-05 15:41:09.132 [main] INFO  nextflow.script.BaseScript - ▶ Threads / RAM:          8  /  32 GB
Jul-05 15:41:09.730 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:VALIDATE_FASTA` matches process VALIDATE_FASTA
Jul-05 15:41:09.731 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:VALIDATE_FASTA|SUMMARY_REPORT|SPLIT_STRAINS|CLUSTER_SUMMARY` matches process VALIDATE_FASTA
Jul-05 15:41:09.736 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: local
Jul-05 15:41:09.736 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
Jul-05 15:41:09.739 [main] DEBUG nextflow.executor.Executor - [warm up] executor > local
Jul-05 15:41:09.742 [main] DEBUG n.processor.LocalPollingMonitor - Creating local task monitor for executor 'local' > cpus=22; memory=62.3 GB; capacity=22; pollInterval=100ms; dumpInterval=5m
Jul-05 15:41:09.743 [main] DEBUG n.processor.TaskPollingMonitor - >>> barrier register (monitor: local)
Jul-05 15:41:09.755 [main] DEBUG nextflow.processor.TaskProcessor - Creating process 'VALIDATE_FASTA': maxForks=0; fair=false; array=0
Jul-05 15:41:09.793 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:MASH_SKETCH` matches process MASH_SKETCH
Jul-05 15:41:09.794 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:MASH_SKETCH|MASH_DIST` matches process MASH_SKETCH
Jul-05 15:41:09.795 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: local
Jul-05 15:41:09.795 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
Jul-05 15:41:09.796 [main] DEBUG nextflow.processor.TaskProcessor - Creating process 'MASH_SKETCH': maxForks=0; fair=false; array=0
Jul-05 15:41:09.799 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:MASH_DIST` matches process MASH_DIST
Jul-05 15:41:09.799 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:MASH_SKETCH|MASH_DIST` matches process MASH_DIST
Jul-05 15:41:09.800 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: local
Jul-05 15:41:09.800 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
Jul-05 15:41:09.801 [main] DEBUG nextflow.processor.TaskProcessor - Creating process 'MASH_DIST': maxForks=0; fair=false; array=0
Jul-05 15:41:09.804 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:BIN_SUBSAMPLE` matches process BIN_SUBSAMPLE
Jul-05 15:41:09.805 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: local
Jul-05 15:41:09.805 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
Jul-05 15:41:09.806 [main] DEBUG nextflow.processor.TaskProcessor - Creating process 'BIN_SUBSAMPLE': maxForks=0; fair=false; array=0
Jul-05 15:41:09.811 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:POPPUNK_MODEL` matches process POPPUNK_MODEL
Jul-05 15:41:09.812 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:POPPUNK_MODEL|POPPUNK_ASSIGN` matches process POPPUNK_MODEL
Jul-05 15:41:09.813 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: local
Jul-05 15:41:09.814 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
Jul-05 15:41:09.815 [main] DEBUG nextflow.processor.TaskProcessor - Creating process 'POPPUNK_MODEL': maxForks=0; fair=false; array=0
Jul-05 15:41:09.820 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:POPPUNK_ASSIGN` matches process POPPUNK_ASSIGN
Jul-05 15:41:09.820 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:POPPUNK_MODEL|POPPUNK_ASSIGN` matches process POPPUNK_ASSIGN
Jul-05 15:41:09.821 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: local
Jul-05 15:41:09.821 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
Jul-05 15:41:09.822 [main] DEBUG nextflow.processor.TaskProcessor - Creating process 'POPPUNK_ASSIGN': maxForks=0; fair=false; array=0
Jul-05 15:41:09.827 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:SUMMARY_REPORT` matches process SUMMARY_REPORT
Jul-05 15:41:09.828 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:VALIDATE_FASTA|SUMMARY_REPORT|SPLIT_STRAINS|CLUSTER_SUMMARY` matches process SUMMARY_REPORT
Jul-05 15:41:09.829 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: local
Jul-05 15:41:09.829 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
Jul-05 15:41:09.830 [main] DEBUG nextflow.processor.TaskProcessor - Creating process 'SUMMARY_REPORT': maxForks=0; fair=false; array=0
Jul-05 15:41:09.856 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:SPLIT_STRAINS` matches process SPLIT_STRAINS
Jul-05 15:41:09.857 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:VALIDATE_FASTA|SUMMARY_REPORT|SPLIT_STRAINS|CLUSTER_SUMMARY` matches process SPLIT_STRAINS
Jul-05 15:41:09.859 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: local
Jul-05 15:41:09.859 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
Jul-05 15:41:09.860 [main] DEBUG nextflow.processor.TaskProcessor - Creating process 'SPLIT_STRAINS': maxForks=0; fair=false; array=0
Jul-05 15:41:09.879 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:SKETCHLIB_DISTS` matches process SKETCHLIB_DISTS
Jul-05 15:41:09.879 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:SKETCHLIB_DISTS|GENERATE_NJ|SKA_BUILD|SKA_ALIGN|SKA_MAP|IQ_TREE|GUBBINS|FASTBAPS` matches process SKETCHLIB_DISTS
Jul-05 15:41:09.884 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: local
Jul-05 15:41:09.885 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
Jul-05 15:41:09.886 [main] DEBUG nextflow.processor.TaskProcessor - Creating process 'SKETCHLIB_DISTS': maxForks=0; fair=false; array=0
Jul-05 15:41:09.892 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:GENERATE_NJ` matches process GENERATE_NJ
Jul-05 15:41:09.892 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:SKETCHLIB_DISTS|GENERATE_NJ|SKA_BUILD|SKA_ALIGN|SKA_MAP|IQ_TREE|GUBBINS|FASTBAPS` matches process GENERATE_NJ
Jul-05 15:41:09.894 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: local
Jul-05 15:41:09.894 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
Jul-05 15:41:09.894 [main] DEBUG nextflow.processor.TaskProcessor - Creating process 'GENERATE_NJ': maxForks=0; fair=false; array=0
Jul-05 15:41:09.899 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:SKA_BUILD` matches process SKA_BUILD
Jul-05 15:41:09.900 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:SKETCHLIB_DISTS|GENERATE_NJ|SKA_BUILD|SKA_ALIGN|SKA_MAP|IQ_TREE|GUBBINS|FASTBAPS` matches process SKA_BUILD
Jul-05 15:41:09.901 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: local
Jul-05 15:41:09.901 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
Jul-05 15:41:09.902 [main] DEBUG nextflow.processor.TaskProcessor - Creating process 'SKA_BUILD': maxForks=0; fair=false; array=0
Jul-05 15:41:09.907 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:SKA_ALIGN` matches process SKA_ALIGN
Jul-05 15:41:09.908 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:SKETCHLIB_DISTS|GENERATE_NJ|SKA_BUILD|SKA_ALIGN|SKA_MAP|IQ_TREE|GUBBINS|FASTBAPS` matches process SKA_ALIGN
Jul-05 15:41:09.909 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: local
Jul-05 15:41:09.909 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
Jul-05 15:41:09.910 [main] DEBUG nextflow.processor.TaskProcessor - Creating process 'SKA_ALIGN': maxForks=0; fair=false; array=0
Jul-05 15:41:09.914 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:SKA_MAP` matches process SKA_MAP
Jul-05 15:41:09.914 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:SKETCHLIB_DISTS|GENERATE_NJ|SKA_BUILD|SKA_ALIGN|SKA_MAP|IQ_TREE|GUBBINS|FASTBAPS` matches process SKA_MAP
Jul-05 15:41:09.915 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: local
Jul-05 15:41:09.915 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
Jul-05 15:41:09.916 [main] DEBUG nextflow.processor.TaskProcessor - Creating process 'SKA_MAP': maxForks=0; fair=false; array=0
Jul-05 15:41:09.921 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:IQ_TREE` matches process IQ_TREE
Jul-05 15:41:09.922 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:SKETCHLIB_DISTS|GENERATE_NJ|SKA_BUILD|SKA_ALIGN|SKA_MAP|IQ_TREE|GUBBINS|FASTBAPS` matches process IQ_TREE
Jul-05 15:41:09.923 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: local
Jul-05 15:41:09.923 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
Jul-05 15:41:09.923 [main] DEBUG nextflow.processor.TaskProcessor - Creating process 'IQ_TREE': maxForks=0; fair=false; array=0
Jul-05 15:41:09.928 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:GUBBINS` matches process GUBBINS
Jul-05 15:41:09.929 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:SKETCHLIB_DISTS|GENERATE_NJ|SKA_BUILD|SKA_ALIGN|SKA_MAP|IQ_TREE|GUBBINS|FASTBAPS` matches process GUBBINS
Jul-05 15:41:09.930 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: local
Jul-05 15:41:09.930 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
Jul-05 15:41:09.930 [main] DEBUG nextflow.processor.TaskProcessor - Creating process 'GUBBINS': maxForks=0; fair=false; array=0
Jul-05 15:41:09.935 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:FASTBAPS` matches process FASTBAPS
Jul-05 15:41:09.936 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:SKETCHLIB_DISTS|GENERATE_NJ|SKA_BUILD|SKA_ALIGN|SKA_MAP|IQ_TREE|GUBBINS|FASTBAPS` matches process FASTBAPS
Jul-05 15:41:09.937 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: local
Jul-05 15:41:09.937 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
Jul-05 15:41:09.938 [main] DEBUG nextflow.processor.TaskProcessor - Creating process 'FASTBAPS': maxForks=0; fair=false; array=0
Jul-05 15:41:09.944 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:CLUSTER_SUMMARY` matches process CLUSTER_SUMMARY
Jul-05 15:41:09.944 [main] DEBUG nextflow.script.ProcessConfig - Config settings `withName:VALIDATE_FASTA|SUMMARY_REPORT|SPLIT_STRAINS|CLUSTER_SUMMARY` matches process CLUSTER_SUMMARY
Jul-05 15:41:09.945 [main] DEBUG nextflow.executor.ExecutorFactory - << taskConfig executor: local
Jul-05 15:41:09.945 [main] DEBUG nextflow.executor.ExecutorFactory - >> processorType: 'local'
Jul-05 15:41:09.946 [main] DEBUG nextflow.processor.TaskProcessor - Creating process 'CLUSTER_SUMMARY': maxForks=0; fair=false; array=0
Jul-05 15:41:09.951 [main] DEBUG nextflow.Session - Workflow process names [dsl2]: CLUSTER_SUMMARY, MASH_DIST, MASH_SKETCH, SUMMARY_REPORT, SKA_MAP, GUBBINS, POPPUNK_MODEL, GENERATE_NJ, SPLIT_STRAINS, IQ_TREE, FASTBAPS, BIN_SUBSAMPLE, POPPUNK_ASSIGN, SKA_BUILD, SKETCHLIB_DISTS, VALIDATE_FASTA, SKA_ALIGN
Jul-05 15:41:09.956 [main] DEBUG nextflow.Session - Igniting dataflow network (18)
Jul-05 15:41:09.960 [main] DEBUG nextflow.processor.TaskProcessor - Starting process > VALIDATE_FASTA
Jul-05 15:41:09.960 [main] DEBUG nextflow.processor.TaskProcessor - Starting process > MASH_SKETCH
Jul-05 15:41:09.960 [main] DEBUG nextflow.processor.TaskProcessor - Starting process > MASH_DIST
Jul-05 15:41:09.961 [main] DEBUG nextflow.processor.TaskProcessor - Starting process > BIN_SUBSAMPLE
Jul-05 15:41:09.961 [main] DEBUG nextflow.processor.TaskProcessor - Starting process > POPPUNK_MODEL
Jul-05 15:41:09.961 [main] DEBUG nextflow.processor.TaskProcessor - Starting process > POPPUNK_ASSIGN
Jul-05 15:41:09.961 [PathVisitor-1] DEBUG nextflow.file.PathVisitor - files for syntax: glob; folder: ./test_data/; pattern: *.fasta; options: [checkIfExists:true]
Jul-05 15:41:09.961 [main] DEBUG nextflow.processor.TaskProcessor - Starting process > SUMMARY_REPORT
Jul-05 15:41:09.961 [main] DEBUG nextflow.processor.TaskProcessor - Starting process > SPLIT_STRAINS
Jul-05 15:41:09.961 [main] DEBUG nextflow.processor.TaskProcessor - Starting process > SKETCHLIB_DISTS
Jul-05 15:41:09.961 [main] DEBUG nextflow.processor.TaskProcessor - Starting process > GENERATE_NJ
Jul-05 15:41:09.961 [main] DEBUG nextflow.processor.TaskProcessor - Starting process > SKA_BUILD
Jul-05 15:41:09.961 [main] DEBUG nextflow.processor.TaskProcessor - Starting process > SKA_ALIGN
Jul-05 15:41:09.961 [main] DEBUG nextflow.processor.TaskProcessor - Starting process > SKA_MAP
Jul-05 15:41:09.961 [main] DEBUG nextflow.processor.TaskProcessor - Starting process > IQ_TREE
Jul-05 15:41:09.961 [main] DEBUG nextflow.processor.TaskProcessor - Starting process > GUBBINS
Jul-05 15:41:09.962 [main] DEBUG nextflow.processor.TaskProcessor - Starting process > FASTBAPS
Jul-05 15:41:09.962 [main] DEBUG nextflow.processor.TaskProcessor - Starting process > CLUSTER_SUMMARY
Jul-05 15:41:09.963 [main] DEBUG nextflow.script.ScriptRunner - Parsed script files:
  Script_677dd16b95346779: /home/phemarajata/combined_poppunk_poppipe/modules/local/sketchlib_dists.nf
  Script_7417cabf5d46dadf: /home/phemarajata/combined_poppunk_poppipe/modules/local/mash_dist.nf
  Script_76700f7dcaf7707b: /home/phemarajata/combined_poppunk_poppipe/modules/local/cluster_summary.nf
  Script_44b71d4f2433afd4: /home/phemarajata/combined_poppunk_poppipe/modules/local/split_strains.nf
  Script_891e0541a8f2d6fb: /home/phemarajata/combined_poppunk_poppipe/modules/local/iq_tree.nf
  Script_8bd64ce80dadba0f: /home/phemarajata/combined_poppunk_poppipe/modules/local/bin_subsample.nf
  Script_7477e1083e159689: /home/phemarajata/combined_poppunk_poppipe/modules/local/fastbaps.nf
  Script_a1ab2c7ded95b477: /home/phemarajata/combined_poppunk_poppipe/modules/local/ska_align.nf
  Script_6c8e74bc7db61953: /home/phemarajata/combined_poppunk_poppipe/modules/local/summary_report.nf
  Script_09945ad10bc74bcc: /home/phemarajata/combined_poppunk_poppipe/modules/local/generate_nj.nf
  Script_af0f02598d046699: /home/phemarajata/combined_poppunk_poppipe/modules/local/gubbins.nf
  Script_e67f2187490eca95: /home/phemarajata/combined_poppunk_poppipe/modules/local/poppunk_model.nf
  Script_e47589c9cace8ded: /home/phemarajata/combined_poppunk_poppipe/main.nf
  Script_300c7946cb49b7c2: /home/phemarajata/combined_poppunk_poppipe/modules/local/validate_fasta.nf
  Script_738804b76b5e015c: /home/phemarajata/combined_poppunk_poppipe/modules/local/poppunk_assign.nf
  Script_12bfbeedcd9a399d: /home/phemarajata/combined_poppunk_poppipe/modules/local/ska_map.nf
  Script_0479f6cbd4bfc016: /home/phemarajata/combined_poppunk_poppipe/modules/local/ska_build.nf
  Script_2a94688d5202e40d: /home/phemarajata/combined_poppunk_poppipe/modules/local/mash_sketch.nf
Jul-05 15:41:09.963 [main] DEBUG nextflow.script.ScriptRunner - > Awaiting termination 
Jul-05 15:41:09.963 [main] DEBUG nextflow.Session - Session await
Jul-05 15:41:10.112 [Task submitter] DEBUG n.executor.local.LocalTaskHandler - Launch cmd line: /bin/bash -ue .command.run
Jul-05 15:41:10.114 [Task submitter] INFO  nextflow.Session - [07/887d4c] Submitted process > VALIDATE_FASTA (validate_fasta)
Jul-05 15:41:24.874 [Task monitor] DEBUG n.processor.TaskPollingMonitor - Task completed > TaskHandler[id: 1; name: VALIDATE_FASTA (validate_fasta); status: COMPLETED; exit: 0; error: -; workDir: /home/phemarajata/combined_poppunk_poppipe/work/07/887d4c61d8f5fe1d2f47aa680d08e7]
Jul-05 15:41:24.875 [Task monitor] DEBUG nextflow.util.ThreadPoolBuilder - Creating thread pool 'TaskFinalizer' minSize=10; maxSize=66; workQueue=LinkedBlockingQueue[-1]; allowCoreThreadTimeout=false
Jul-05 15:41:24.883 [Actor Thread 16] INFO  nextflow.script.BaseScript - 
==================================================
Jul-05 15:41:24.890 [Actor Thread 16] INFO  nextflow.script.BaseScript - 📋 FASTA VALIDATION REPORT
Jul-05 15:41:24.891 [Actor Thread 16] INFO  nextflow.script.BaseScript - ==================================================
Jul-05 15:41:24.892 [Actor Thread 16] INFO  nextflow.script.BaseScript - FASTA Validation Report
======================
Total files processed: 21
Valid files: 21
Invalid files: 0

Valid files (with absolute paths):
  ✓ /home/phemarajata/combined_poppunk_poppipe/test_data/genome_cluster2_3.fasta
  ✓ /home/phemarajata/combined_poppunk_poppipe/test_data/genome_cluster1_4.fasta
  ✓ /home/phemarajata/combined_poppunk_poppipe/test_data/outlier_3.fasta
  ✓ /home/phemarajata/combined_poppunk_poppipe/test_data/genome_cluster2_6.fasta
  ✓ /home/phemarajata/combined_poppunk_poppipe/test_data/genome_cluster1_1.fasta
  ✓ /home/phemarajata/combined_poppunk_poppipe/test_data/genome_cluster1_7.fasta
  ✓ /home/phemarajata/combined_poppunk_poppipe/test_data/genome_cluster2_5.fasta
  ✓ /home/phemarajata/combined_poppunk_poppipe/test_data/genome_cluster3_2.fasta
  ✓ /home/phemarajata/combined_poppunk_poppipe/test_data/genome_cluster2_2.fasta
  ✓ /home/phemarajata/combined_poppunk_poppipe/test_data/genome_cluster2_4.fasta
  ✓ /home/phemarajata/combined_poppunk_poppipe/test_data/genome_cluster1_6.fasta
  ✓ /home/phemarajata/combined_poppunk_poppipe/test_data/genome_cluster3_4.fasta
  ✓ /home/phemarajata/combined_poppunk_poppipe/test_data/genome_cluster1_3.fasta
  ✓ /home/phemarajata/combined_poppunk_poppipe/test_data/genome_cluster2_1.fasta
  ✓ /home/phemarajata/combined_poppunk_poppipe/test_data/outlier_2.fasta
  ✓ /home/phemarajata/combined_poppunk_poppipe/test_data/outlier_1.fasta
  ✓ /home/phemarajata/combined_poppunk_poppipe/test_data/genome_cluster1_5.fasta
  ✓ /home/phemarajata/combined_poppunk_poppipe/test_data/genome_cluster1_8.fasta
  ✓ /home/phemarajata/combined_poppunk_poppipe/test_data/genome_cluster3_3.fasta
  ✓ /home/phemarajata/combined_poppunk_poppipe/test_data/genome_cluster3_1.fasta
  ✓ /home/phemarajata/combined_poppunk_poppipe/test_data/genome_cluster1_2.fasta


Jul-05 15:41:24.892 [Actor Thread 16] INFO  nextflow.script.BaseScript - ==================================================

Jul-05 15:41:24.897 [TaskFinalizer-1] DEBUG nextflow.util.ThreadPoolBuilder - Creating thread pool 'PublishDir' minSize=10; maxSize=66; workQueue=LinkedBlockingQueue[-1]; allowCoreThreadTimeout=false
Jul-05 15:41:24.913 [Task submitter] DEBUG n.executor.local.LocalTaskHandler - Launch cmd line: /bin/bash -ue .command.run
Jul-05 15:41:24.918 [Task submitter] INFO  nextflow.Session - [db/7ea943] Submitted process > MASH_SKETCH (mash_sketch)
Jul-05 15:41:50.077 [Task monitor] DEBUG n.processor.TaskPollingMonitor - Task completed > TaskHandler[id: 2; name: MASH_SKETCH (mash_sketch); status: COMPLETED; exit: 0; error: -; workDir: /home/phemarajata/combined_poppunk_poppipe/work/db/7ea94379833c4adf7e2406876d3775]
Jul-05 15:41:50.088 [Task submitter] DEBUG n.executor.local.LocalTaskHandler - Launch cmd line: /bin/bash -ue .command.run
Jul-05 15:41:50.088 [Task submitter] INFO  nextflow.Session - [db/5d8353] Submitted process > MASH_DIST (mash_dist)
Jul-05 15:41:50.369 [Task monitor] DEBUG n.processor.TaskPollingMonitor - Task completed > TaskHandler[id: 3; name: MASH_DIST (mash_dist); status: COMPLETED; exit: 0; error: -; workDir: /home/phemarajata/combined_poppunk_poppipe/work/db/5d8353d52956e470dd3a281621f679]
Jul-05 15:41:50.386 [Task submitter] DEBUG n.executor.local.LocalTaskHandler - Launch cmd line: /bin/bash -ue .command.run
Jul-05 15:41:50.387 [Task submitter] INFO  nextflow.Session - [a4/bfbe52] Submitted process > BIN_SUBSAMPLE (bin_subsample)
Jul-05 15:41:51.795 [Task monitor] DEBUG n.processor.TaskPollingMonitor - Task completed > TaskHandler[id: 4; name: BIN_SUBSAMPLE (bin_subsample); status: COMPLETED; exit: 1; error: -; workDir: /home/phemarajata/combined_poppunk_poppipe/work/a4/bfbe520accfd80afe6cb96a0d588a5]
Jul-05 15:41:51.800 [TaskFinalizer-4] DEBUG nextflow.processor.TaskProcessor - Handling unexpected condition for
  task: name=BIN_SUBSAMPLE (bin_subsample); work-dir=/home/phemarajata/combined_poppunk_poppipe/work/a4/bfbe520accfd80afe6cb96a0d588a5
  error [nextflow.exception.ProcessFailedException]: Process `BIN_SUBSAMPLE (bin_subsample)` terminated with an error exit status (1)
Jul-05 15:41:51.805 [TaskFinalizer-4] INFO  nextflow.processor.TaskProcessor - [a4/bfbe52] NOTE: Process `BIN_SUBSAMPLE (bin_subsample)` terminated with an error exit status (1) -- Execution is retried (1)
Jul-05 15:41:51.811 [Task submitter] DEBUG n.executor.local.LocalTaskHandler - Launch cmd line: /bin/bash -ue .command.run
Jul-05 15:41:51.811 [Task submitter] INFO  nextflow.Session - [e9/ba71eb] Re-submitted process > BIN_SUBSAMPLE (bin_subsample)
Jul-05 15:41:53.201 [Task monitor] DEBUG n.processor.TaskPollingMonitor - Task completed > TaskHandler[id: 5; name: BIN_SUBSAMPLE (bin_subsample); status: COMPLETED; exit: 1; error: -; workDir: /home/phemarajata/combined_poppunk_poppipe/work/e9/ba71eba9f580ca68e0fb4833ea2a76]
Jul-05 15:41:53.203 [TaskFinalizer-5] DEBUG nextflow.processor.TaskProcessor - Handling unexpected condition for
  task: name=BIN_SUBSAMPLE (bin_subsample); work-dir=/home/phemarajata/combined_poppunk_poppipe/work/e9/ba71eba9f580ca68e0fb4833ea2a76
  error [nextflow.exception.ProcessFailedException]: Process `BIN_SUBSAMPLE (bin_subsample)` terminated with an error exit status (1)
Jul-05 15:41:53.203 [TaskFinalizer-5] INFO  nextflow.processor.TaskProcessor - [e9/ba71eb] NOTE: Process `BIN_SUBSAMPLE (bin_subsample)` terminated with an error exit status (1) -- Execution is retried (2)
Jul-05 15:41:53.208 [Task submitter] DEBUG n.executor.local.LocalTaskHandler - Launch cmd line: /bin/bash -ue .command.run
Jul-05 15:41:53.208 [Task submitter] INFO  nextflow.Session - [fe/bbda82] Re-submitted process > BIN_SUBSAMPLE (bin_subsample)
Jul-05 15:41:54.604 [Task monitor] DEBUG n.processor.TaskPollingMonitor - Task completed > TaskHandler[id: 6; name: BIN_SUBSAMPLE (bin_subsample); status: COMPLETED; exit: 1; error: -; workDir: /home/phemarajata/combined_poppunk_poppipe/work/fe/bbda82a49a475533d740873ddbbcb0]
Jul-05 15:41:54.606 [TaskFinalizer-6] DEBUG nextflow.processor.TaskProcessor - Handling unexpected condition for
  task: name=BIN_SUBSAMPLE (bin_subsample); work-dir=/home/phemarajata/combined_poppunk_poppipe/work/fe/bbda82a49a475533d740873ddbbcb0
  error [nextflow.exception.ProcessFailedException]: Process `BIN_SUBSAMPLE (bin_subsample)` terminated with an error exit status (1)
Jul-05 15:41:54.613 [TaskFinalizer-6] ERROR nextflow.processor.TaskProcessor - Error executing process > 'BIN_SUBSAMPLE (bin_subsample)'

Caused by:
  Process `BIN_SUBSAMPLE (bin_subsample)` terminated with an error exit status (1)


Command executed:

  pip install --quiet networkx
      python - << 'PY'
  import networkx as nx, random, sys, pathlib, os
  
  print("Building similarity graph from MASH distances...")
  
  # This is the absolute path to your main input directory
  input_dir = "./test_data"
  
  G = nx.Graph()
  # Process the mash distance file - files are now relative filenames
  for line in open('mash.dist'):
      a, b, d, *_ = line.split()
      if float(d) < 0.01:
          G.add_edge(a, b)
  
  print(f"Graph built with {G.number_of_nodes()} nodes and {G.number_of_edges()} edges")
  print(f"Found {nx.number_connected_components(G)} connected components")
  
  # Analyze component sizes for debugging
  component_sizes = [len(comp) for comp in nx.connected_components(G)]
  component_sizes.sort(reverse=True)
  print(f"Component sizes: {component_sizes[:10]}")  # Show top 10 component sizes
  print(f"Largest component has {max(component_sizes) if component_sizes else 0} genomes")
  print(f"Average component size: {sum(component_sizes)/len(component_sizes) if component_sizes else 0:.1f}")
  
  with open('subset.list','w') as out:
      total_selected = 0
      for i, comp in enumerate(nx.connected_components(G)):
          comp = list(comp)
          # Optimized subsampling for better cluster resolution: take fewer but more diverse representatives
          k = min(100, max(10, int(len(comp) * 0.15)))
          k = min(k, len(comp))
          if k > 0:
              selected = random.sample(comp, k)
              for filename in selected:
                  # Create a sample name from the filename
                  sample_name = os.path.splitext(filename)[0]
                  # Create the full absolute path for PopPUNK to use
                  full_path = os.path.join(input_dir, filename)
                  out.write(f"{sample_name}\t{full_path}\n")
                  total_selected += 1
          print(f"Component {i+1}: {len(comp)} genomes -> selected {k} representatives")
  
  print(f"Total genomes selected for PopPUNK modeling: {total_selected}")
  PY

Command exit status:
  1

Command output:
  (empty)

Command error:
  WARNING: The directory '/.cache/pip' or its parent directory is not owned or is not writable by the current user. The cache has been disabled. Check the permissions and owner of that directory. If executing pip with sudo, you should use sudo's -H flag.
  ERROR: Could not install packages due to an OSError: [Errno 13] Permission denied: '/.local'
  Check the permissions.
  
  
  [notice] A new release of pip is available: 23.0.1 -> 25.1.1
  [notice] To update, run: pip install --upgrade pip

Work dir:
  /home/phemarajata/combined_poppunk_poppipe/work/fe/bbda82a49a475533d740873ddbbcb0

Container:
  python:3.9

Tip: you can try to figure out what's wrong by changing to the process work dir and showing the script file named `.command.sh`
Jul-05 15:41:54.614 [TaskFinalizer-6] DEBUG nextflow.Session - Session aborted -- Cause: Process `BIN_SUBSAMPLE (bin_subsample)` terminated with an error exit status (1)
Jul-05 15:41:54.615 [main] DEBUG nextflow.Session - Session await > all processes finished
Jul-05 15:41:54.624 [main] DEBUG nextflow.Session - Session await > all barriers passed
Jul-05 15:41:54.624 [Task monitor] DEBUG n.processor.TaskPollingMonitor - <<< barrier arrives (monitor: local) - terminating tasks monitor poll loop
Jul-05 15:41:54.625 [main] INFO  nextflow.script.BaseScript - 
╔══════════════════════════════════════════════════════════════════════════════╗
║                    COMBINED POPPUNK + POPPIPE PIPELINE                       ║
║                                 COMPLETED                                    ║
╠══════════════════════════════════════════════════════════════════════════════╣
║ Phase 1 (PopPUNK): Bacterial genome clustering completed                    ║
║ Phase 2 (PopPIPE): Downstream analysis and subclustering completed          ║
║                                                                              ║
║ Results available in: ./test_results                                  ║
║                                                                              ║
║ Key outputs:                                                                 ║
║ - PopPUNK clusters: poppunk_full/full_assign.csv                           ║
║ - PopPIPE subclusters: output/all_clusters.txt                             ║
║ - Summary reports: summary/pipeline_summary.txt                             ║
╚══════════════════════════════════════════════════════════════════════════════╝

Jul-05 15:41:54.628 [main] DEBUG n.trace.WorkflowStatsObserver - Workflow completed > WorkflowStats[succeededCount=3; failedCount=3; ignoredCount=0; cachedCount=0; pendingCount=0; submittedCount=0; runningCount=0; retriesCount=2; abortedCount=0; succeedDuration=304ms; failedDuration=7.9s; cachedDuration=0ms;loadCpus=0; loadMemory=0; peakRunning=1; peakCpus=8; peakMemory=32 GB; ]
Jul-05 15:41:54.628 [main] DEBUG nextflow.trace.TraceFileObserver - Workflow completed -- saving trace file
Jul-05 15:41:54.629 [main] DEBUG nextflow.trace.ReportObserver - Workflow completed -- rendering execution report
Jul-05 15:41:54.951 [main] DEBUG nextflow.trace.TimelineObserver - Workflow completed -- rendering execution timeline
Jul-05 15:41:55.010 [main] DEBUG nextflow.cache.CacheDB - Closing CacheDB done
Jul-05 15:41:55.018 [main] DEBUG nextflow.script.ScriptRunner - > Execution complete -- Goodbye
